# Convert a NAT service plan to an EIP bandwidth plan

You can convert an existing NAT service plan to an elastic IP address \(EIP\) bandwidth plan. EIP bandwidth plans support bandwidth sharing and transferring on a regional scale. After you purchase an EIP bandwidth plan, you can add all EIPs in the same region to the EIP bandwidth plan. This saves bandwidth costs because these EIPs can share and transfer the bandwidth of the EIP bandwidth plan.

## Considerations

When you convert a NAT service plan to an EIP bandwidth plan, network connections are uninterrupted and your online workloads are not affected. After conversion:

-   The public IP addresses in the NAT service plan are converted to EIPs.
-   The NAT service plan is converted to a shared bandwidth plan, which is easier to manage and more cost-effective.
-   If the conversion fails, you can continue to use the NAT service plan. If you fail to locate the cause of the conversion failure, [submit a ticket](https://workorder-intl.console.aliyun.com/#/ticket/createIndex). When you submit a ticket, you must provide the following information:
    -   Your account ID or UID.
    -   The request ID generated by Alibaba Cloud when you call the ConvertBandwidthPackage operation.
    -   The ID of the NAT service plan that failed to be converted.
    -   The screenshot of the conversion failure.

## Prerequisites

Before you convert a NAT service plan, make sure that the following requirements are met:

-   Your account has the permissions to convert the NAT service plan.

    We recommend that you use your Alibaba Cloud account to convert the NAT service plan. If you want to convert the NAT service plan as a Resource Access Management \(RAM\) user, you must first log on to the [RAM console](https://ram.console.aliyun.com/users) with your Alibaba Cloud account and grant the RAM user the following permissions:

    -   AliyunNATGatewayFullAccess
    -   AliyunEIPFullAccess
    -   AliyunCommonBandwidthPackageFullAccess

        ![Authorize](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/en-US/7896359851/p96384.png)

-   Your account has sufficient unused EIPs.

    After the NAT service plan is converted, the public IP addresses in the NAT service plan are converted to EIPs. Make sure that the number of EIPs is greater than or equal to the number of public IP addresses in the NAT service plan. In the Virtual Private Cloud \(VPC\) console, you can view the number of EIPs on the [Quota Management](https://vpc.console.aliyun.com/quota) page. If the number of EIPs is insufficient, you can apply for more in the VPC console.

    ![Quota Management](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/en-US/7896359851/p96382.png)

-   Your account is in the whitelist if the NAT service plan is charged on a pay-by-data-transfer basis.

    If the NAT service plan to be converted is billed on a pay-by-data-transfer basis, [submit a ticket](https://workorder-intl.console.aliyun.com/#/ticket/createIndex) to apply for the permission to convert the NAT service plan.

-   The information about the NAT service plan is backed up.

    Before you convert your NAT service plan, fill the following table with the NAT service plan information, so that you can track the conversion progress and verify the result.

    |The ID of the NAT service plan|Region|Maximum bandwidth|The number of public IP addresses|Conversion status|The ID of the EIP bandwidth plan|
    |------------------------------|------|-----------------|---------------------------------|-----------------|--------------------------------|
    |bwp-xxx1|China \(Hangzhou\)|200M|20|Successful|cbwp-xxx1|
    |bwp-xxx2|China \(Shanghai\)|500M|50|Pending|N/A|


## Procedure

After the prerequisites are met, perform the following operations to start the conversion:

1.  Apply for the permission:

    1.  Open the [Quota Management](https://vpc.console.aliyun.com/quota) page and click the **NAT Gateway** tab.

    2.  Find **natgw\_privilege\_allow\_bwp\_convert\_cbwp** and click **Apply**.

    3.  Enter the reason for the application and click **OK**.

    4.  Wait one minute and click the Refresh icon. The latest status of the application is displayed.

        The application is automatically reviewed. **Permission Acquired** indicates that the application is approved.

        ![The NAT Gateway tab](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/en-US/7896359851/p96399.png)

2.  Call the [ConvertBandwidthPackage](https://api.aliyun.com/?#/?product=Vpc&version=2016-04-28&api=ConvertBandwidthPackage&params=%7B%7D&tab=DOC&lang=JAVA) operation to complete the conversion.

3.  Verify the conversion result.

    You can check the ID of the EIP bandwidth plan to verify whether the conversion is successful. IDs of NAT service plans are converted based on the following rule: `${cbwpId}='c'+${bwpId}`. For example, the ID of the original NAT service plan is `${bwpId}=bwp-e8caejcj`, the ID of the converted EIP bandwidth plan is `cbwp-e8caejcj`.

4.  After the conversion, navigate to the NAT Gateway tab on the Quota Management page and apply for the **natgw\_privilege\_allow\_bind\_eip** permission to associate the converted EIPs with the NAT gateway. For more information, see [Associate EIPs with a NAT gateway](/intl.en-US/Manage EIPs/Associate EIPs with a NAT gateway.md).

    This application is reviewed automatically. Wait one minute and click the Refresh icon. The latest status of the application is displayed.

    ![The NAT Gateway tab](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/en-US/7896359851/p96400.png)


